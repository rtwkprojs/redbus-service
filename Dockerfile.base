# Base Dockerfile for all services
FROM openjdk:17-jdk-slim

WORKDIR /app

# Add a non-root user
RUN groupadd -r spring && useradd -r -g spring spring

# Common health check script
COPY --chown=spring:spring docker-healthcheck.sh /healthcheck.sh
RUN chmod +x /healthcheck.sh

USER spring

# Default JVM options
ENV JAVA_OPTS="-Xmx512m -Xms256m"

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
